<!DOCTYPE html>
<html lang="id" class="h-full">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Database HMI Mimika</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
body {
    font-family: 'Poppins', sans-serif;
    margin: 0; padding: 0;
    background: linear-gradient(135deg,#f5f7fa 0%,#c3cfe2 100%);
}
#loginBar {
    display:flex;
    justify-content:center;
    align-items:center;
    gap:1rem;
    padding:1rem;
    background: linear-gradient(90deg,#2d5016,#d4af37);
    color:white;
    border-radius:1rem;
    margin:2rem auto;
    max-width:500px;
    box-shadow:0 4px 12px rgba(0,0,0,0.2);
}
#loginBar input {
    padding:0.5rem 1rem;
    border-radius:1rem;
    border:none;
    outline:none;
    font-size:1rem;
}
#loginBar button {
    padding:0.5rem 1.5rem;
    border-radius:1rem;
    border:none;
    background:#fff;
    color:#2d5016;
    font-weight:600;
    cursor:pointer;
    transition:0.3s;
}
#loginBar button:hover { transform:scale(1.05);}
#mainContent {
    display:none; /* tersembunyi sampai login sukses */
    max-width:1200px;
    margin:2rem auto;
    display:flex;
    flex-wrap:wrap;
    gap:1rem;
}
.table-container {
    flex:1 1 65%;
    overflow-x:auto;
    background:white;
    border-radius:1rem;
    padding:1rem;
    box-shadow:0 4px 12px rgba(0,0,0,0.1);
}
table {
    border-collapse: collapse;
    width: 100%;
}
th, td {
    padding:0.75rem 1rem;
    text-align:left;
    border-bottom:1px solid #ddd;
    font-size:0.95rem;
}
th {
    background: linear-gradient(90deg,#2d5016,#d4af37);
    color:white;
    position:sticky;
    top:0;
}
tr:hover {background-color:#f1f5f9;}
#searchBox {
    width:100%;
    padding:0.5rem 1rem;
    border-radius:1rem;
    border:2px solid #ccc;
    margin-bottom:1rem;
}
#searchBox:focus { border-color:#2d5016; outline:none; }
#addMemberBtn {
    flex:1 1 30%;
    background:#2d5016;
    color:white;
    font-weight:600;
    padding:1rem;
    border-radius:2rem;
    cursor:pointer;
    display:flex;
    justify-content:center;
    align-items:center;
    box-shadow:0 4px 12px rgba(0,0,0,0.2);
    transition:0.3s;
}
#addMemberBtn:hover { transform:scale(1.05);}
#tallyFormContainer {
    flex:1 1 30%;
    background:#d4af37;
    border-radius:1rem;
    overflow:hidden;
    max-height:0;
    transition:max-height 0.5s ease;
}
#tallyFormContainer iframe {
    width:100%;
    border:none;
    height:600px;
}
#tallyFormContainer.active {
    max-height:700px; /* ketika muncul */
    transition:max-height 0.7s ease;
}
</style>
</head>
<body>

<!-- LOGIN BAR -->
<div id="loginBar">
    <input type="text" id="username" placeholder="Username">
    <input type="password" id="password" placeholder="Password">
    <button id="loginBtn">Login</button>
</div>

<!-- MAIN CONTENT -->
<div id="mainContent">
    <!-- Tabel -->
    <div class="table-container">
        <input type="text" id="searchBox" placeholder="ðŸ” Cari nama, NIK, komisariat, atau PT...">
        <table id="membersTable">
            <thead>
                <tr>
                    <th>NIK</th>
                    <th>Nama Lengkap</th>
                    <th>Nomor Telepon/HP</th>
                    <th>Alamat Email</th>
                    <th>Tanggal Lahir</th>
                    <th>Alamat</th>
                    <th>Jenis Kelamin</th>
                    <th>Status Anggota</th>
                    <th>Masuk HMI Tahun</th>
                    <th>Perguruan Tinggi</th>
                    <th>Komisariat Asal</th>
                    <th>Jabatan di HMI</th>
                    <th>Posisi Jabatan</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <!-- Tombol tambah anggota -->
    <div style="display:flex; flex-direction:column; gap:1rem;">
        <div id="addMemberBtn">âž• Tambah Anggota</div>
        <div id="tallyFormContainer">
            <iframe src="https://tally.so/embed/BzxN1Q?alignLeft=1&hideTitle=1&transparentBackground=1&dynamicHeight=1"></iframe>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
<script>
const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRkxnLr5GK_w_WRktgY-SZZ2pjBHlDVSphEYLLSBLntg0IyQB3Z5178wjaES8-yMQV7ZcMTGym-VoZA/pub?gid=0&single=true&output=csv";

const loginBtn = document.getElementById("loginBtn");
const mainContent = document.getElementById("mainContent");
const usernameInput = document.getElementById("username");
const passwordInput = document.getElementById("password");

loginBtn.addEventListener("click", ()=>{
    const username = usernameInput.value.trim();
    const password = passwordInput.value.trim();
    if(username === "admin" && password === "admin123"){
        document.getElementById("loginBar").style.display = "none";
        mainContent.style.display = "flex";
        fetchAndRenderCSV();
    } else {
        alert("Username atau password salah!");
    }
});

// Fetch CSV dan render tabel
function fetchAndRenderCSV() {
    Papa.parse(csvUrl, {
        download:true,
        header:true,
        skipEmptyLines:true,
        complete:function(results){
            renderTable(results.data);
        }
    });
}

function renderTable(data){
    const tbody = document.querySelector("#membersTable tbody");
    tbody.innerHTML = "";
    data.forEach(member => {
        const row = document.createElement("tr");
        const cols = [
            "Nomor Induk Kader (NIK)",
            "Nama Lengkap",
            "Nomor Telepon/HP",
            "Alamat Email",
            "Tanggal Lahir",
            "Alamat",
            "Jenis Kelamin",
            "Status Anggota",
            "Masuk HMI Tahun",
            "Perguruan Tinggi",
            "Komisariat Asal",
            "Jabatan di HMI",
            "Posisi Jabatan"
        ];
        cols.forEach(col=>{
            const td = document.createElement("td");
            td.textContent = member[col] || "-";
            row.appendChild(td);
        });
        tbody.appendChild(row);
    });
}

// Search filter
document.getElementById("searchBox").addEventListener("input", function(){
    const filter = this.value.toLowerCase();
    document.querySelectorAll("#membersTable tbody tr").forEach(row=>{
        row.style.display = row.textContent.toLowerCase().includes(filter)?"":"none";
    });
});

// Toggle Tally form
const addMemberBtn = document.getElementById("addMemberBtn");
const tallyFormContainer = document.getElementById("tallyFormContainer");
addMemberBtn.addEventListener("click", ()=>{
    tallyFormContainer.classList.toggle("active");
});
</script>
</body>
</html>
