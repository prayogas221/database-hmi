<!DOCTYPE html>
<html lang="id" class="h-full">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Database HMI Mimika</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
body {
    font-family: 'Poppins', sans-serif;
    margin:0; padding:0;
    background: linear-gradient(135deg,#f5f7fa 0%,#c3cfe2 100%);
}
input, button, textarea {
    font-family: 'Poppins', sans-serif;
}
.hidden-section {
    display: none;
}
#loginPage {
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
}
#loginBar {
    max-width: 400px;
    width: 90%;
    padding: 2rem;
    background: linear-gradient(135deg,#2d5016 0%,#ffffff 100%);
    border-radius: 20px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.15);
}
#loginBar h2 {
    text-align: center;
    font-size: 1.75rem;
    font-weight:700;
    margin-bottom:1.5rem;
    color:#2d5016;
}
input[type="text"], input[type="password"] {
    width: 100%;
    padding:0.75rem;
    margin-bottom:1rem;
    border-radius:12px;
    border:2px solid #ccc;
    transition:border-color 0.3s;
}
input[type="text"]:focus, input[type="password"]:focus {
    border-color:#2d5016;
    outline:none;
}
.show-pass-btn {
    position:absolute;
    right:15px;
    top:45%;
    cursor:pointer;
    color:#2d5016;
}
button.login-btn {
    width:100%;
    padding:0.75rem;
    border:none;
    border-radius:12px;
    font-weight:600;
    color:white;
    background:#2d5016;
    cursor:pointer;
    transition:all 0.3s;
}
button.login-btn:hover {
    transform:translateY(-2px);
    box-shadow:0 8px 15px rgba(0,0,0,0.2);
}

/* MAIN PAGE */
#mainContent {
    display:none;
    max-width:1200px;
    margin:2rem auto;
    padding:0 1rem;
}
.table-container {
    overflow-x:auto;
    margin-bottom:1rem;
}
table {
    border-collapse:collapse;
    width:100%;
    border-radius:15px;
    overflow:hidden;
    box-shadow:0 6px 18px rgba(0,0,0,0.1);
}
th, td {
    padding:0.75rem 1rem;
    text-align:left;
    border-bottom:1px solid #ddd;
    font-size:0.95rem;
}
th {
    background: linear-gradient(135deg,#2d5016 0%,#d4af37 100%);
    color:white;
    position:sticky;
    top:0;
}
tr:hover { background-color:#f1f5f9; }
#addMemberBtn {
    padding:1rem 2rem;
    border-radius:20px;
    background: linear-gradient(135deg,#2d5016 0%,#d4af37 100%);
    color:white;
    font-weight:600;
    cursor:pointer;
    transition:all 0.3s;
}
#addMemberBtn:hover { transform:translateY(-3px); box-shadow:0 10px 20px rgba(0,0,0,0.15);}
#tallyFormContainer {
    background:white;
    border-radius:20px;
    padding:1rem;
    box-shadow:0 10px 25px rgba(0,0,0,0.1);
    max-height:0;
    overflow:hidden;
    transition:max-height 0.5s ease, padding 0.5s ease;
    margin-top:1rem;
}
#tallyFormContainer.show {
    max-height:1200px;
    padding:1rem;
}
#tallyFormContainer iframe {
    width:100%;
    height:600px;
    border:none;
    border-radius:15px;
}
.action-btns {
    display:flex;
    gap:0.75rem;
    margin-top:1rem;
}
.action-btns button {
    padding:0.75rem 1.5rem;
    border-radius:15px;
    border:none;
    font-weight:600;
    cursor:pointer;
    transition:all 0.3s;
}
.logout-btn { background:#e74c3c; color:white;}
.logout-btn:hover { transform:translateY(-3px); box-shadow:0 10px 20px rgba(0,0,0,0.15);}
.back-btn { background:#2d5016; color:white;}
.back-btn:hover { transform:translateY(-3px); box-shadow:0 10px 20px rgba(0,0,0,0.15);}
</style>
</head>
<body>

<!-- LOGIN PAGE -->
<div id="loginPage">
    <div id="loginBar">
        <h2>Login Admin</h2>
        <div class="relative">
            <input type="text" id="username" placeholder="Username">
        </div>
        <div class="relative">
            <input type="password" id="password" placeholder="Password">
            <span class="show-pass-btn" onclick="togglePassword()">üëÅÔ∏è</span>
        </div>
        <button class="login-btn" id="loginBtn">Login</button>
    </div>
</div>

<!-- MAIN CONTENT -->
<div id="mainContent">
    <div class="table-container">
        <table id="membersTable">
            <thead>
                <tr>
                    <th>NIK</th>
                    <th>Nama Lengkap</th>
                    <th>Telepon</th>
                    <th>Email</th>
                    <th>Tgl Lahir</th>
                    <th>Alamat</th>
                    <th>JK</th>
                    <th>Status</th>
                    <th>Tahun Masuk</th>
                    <th>Perguruan Tinggi</th>
                    <th>Komisariat</th>
                    <th>Jabatan HMI</th>
                    <th>Posisi</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
        <button id="addMemberBtn">‚ûï Tambah Anggota</button>
    </div>

    <!-- Tally Form -->
    <div id="tallyFormContainer">
        <iframe src="https://tally.so/embed/BzxN1Q?alignLeft=1&hideTitle=1&transparentBackground=1&dynamicHeight=1"></iframe>
        <div class="action-btns">
            <button class="back-btn" onclick="hideForm()">Kembali</button>
            <button class="logout-btn" onclick="logout()">Logout</button>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
<script>
// LOGIN LOGIC
const validUsername = "admin";
const validPassword = "12345";

function togglePassword(){
    const pass = document.getElementById("password");
    pass.type = pass.type==="password"?"text":"password";
}

document.getElementById("loginBtn").addEventListener("click", ()=>{
    const user = document.getElementById("username").value;
    const pass = document.getElementById("password").value;
    if(user===validUsername && pass===validPassword){
        document.getElementById("loginPage").style.display="none";
        document.getElementById("mainContent").style.display="block";
        fetchAndRenderCSV();
    } else {
        alert("Username atau password salah!");
    }
});

// LOGOUT
function logout(){
    document.getElementById("mainContent").style.display="none";
    document.getElementById("loginPage").style.display="flex";
    document.getElementById("username").value="";
    document.getElementById("password").value="";
    hideForm();
}

// SHOW/HIDE FORM
const tallyContainer = document.getElementById("tallyFormContainer");
const addBtn = document.getElementById("addMemberBtn");
addBtn.addEventListener("click", ()=>{
    tallyContainer.classList.add("show");
    document.querySelector(".table-container").style.display="none";
});
function hideForm(){
    tallyContainer.classList.remove("show");
    document.querySelector(".table-container").style.display="block";
}

// CSV TABLE
const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRkxnLr5GK_w_WRktgY-SZZ2pjBHlDVSphEYLLSBLntg0IyQB3Z5178wjaES8-yMQV7ZcMTGym-VoZA/pub?gid=0&single=true&output=csv";
function fetchAndRenderCSV(){
    Papa.parse(csvUrl, {
        download:true,
        header:true,
        skipEmptyLines:true,
        complete:function(results){
            renderTable(results.data);
        }
    });
}

function renderTable(data){
    const tbody = document.querySelector("#membersTable tbody");
    tbody.innerHTML="";
    data.forEach(member=>{
        const row = document.createElement("tr");
        const cols = ["Nomor Induk Kader (NIK)","Nama Lengkap","Nomor Telepon/HP","Alamat Email",
                      "Tanggal Lahir","Alamat","Jenis Kelamin","Status Anggota","Masuk HMI Tahun",
                      "Perguruan Tinggi","Komisariat Asal","Jabatan di HMI","Posisi Jabatan"];
        cols.forEach(col=>{
            const td = document.createElement("td");
            td.textContent = member[col]||"-";
            row.appendChild(td);
        });
        tbody.appendChild(row);
    });
}
</script>

</body>
</html>
